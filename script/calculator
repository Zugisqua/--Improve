#!/bin/bash


#=====-declare=====#
At=('108' '108' '108' '108' '108' '108')

#=====read=====#

cnt=0;j=0;i=1;Ju=1
while read a b c d
do
    if [[ $a != [0-5] ]];then	
	cnt=$((cnt + 1))
	tmp[$cnt]=$a
	Ju=1
	if [[ $cnt != 1 ]];then	    
	    for k in $(seq 1 $((cnt-1)))
	    do
		if [[ ${tmp[$k]} == $a ]];then
		    Ju=$((Ju*0))
		else
		    Ju=$((Ju*1))
		fi
	    done
	fi
	if [[ $Ju = 1 ]] ;then
	    Sub[$i]=$a
	    i=$((i+1))
	fi
	let S_$a[$j-1]=$((S_$a[j-1]+c-b))
	let Tols[$j-1]=$((Tols[j-1]+c-b))
	let C_$a[$j-1]=$((C_$a[j-1]+1))
#-------output-----#
	printf "$((j-1))-$a:\t$((6+b/6)):$((b%6))0-$((6+c/6)):$((c%6))0\t$(((c-b)/6)):$(((c-b)%6))0\n"
	if [[ "$2" = "note" || "$2" = "all" ]];then
	    echo \ \ Notes: $d
	fi	
    else
	echo =========
	echo \ \ Day:$a
	j=$(($j + 1))
    fi	  		
done < $1

#------comment-------#
echo \ 
echo ======================
for k in ${Tols[@]};do TolS=$((TolS+k));done
for k in $(seq 0 $((j-1)))
do
    AT=$((AT+At[$k]))
    printf "[$k] Total Duration: $((Tols[k]/6)):$((Tols[k]%6))0/$((At[k]/6)):$((At[k]%6))0\tOccupy: $((Tols[k]*100/At[k]))%%\n"
done
printf "    Total ALL: $((TolS/6)):$((TolS%6))0/$((AT/6)):$((AT%6))0\tmean: $((TolS*100/AT))%%\n"

if [[ "$2" = "detail" || "$2" = "all" ]];then
    echo ----------------------
    for k in ${Sub[@]}
    do
	echo $k:
	for l in $(seq 0 $((j-1)))
	do
	    let As_$k=$((As_$k+S_$k[l]))
	    let Ac_$k=$((Ac_$k+C_$k[l]))
	    printf "  [$l] $((S_$k[l]/6)):$((S_$k[l]%6))0\t"
	done
	printf "\n  Total: $((As_$k/6)):$((As_$k%6))0\n  Occupy: $((As_$k*100/AT)).$(((As_$k*1000/AT)%10))%% \tAver-duration:  $(((As_$k/Ac_$k)/6)):$(((As_$k/Ac_$k)%6))0\n"
    done
fi



